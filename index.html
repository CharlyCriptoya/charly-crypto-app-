<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Charly Cripto • MVP</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="stylesheet" href="/style.css" />
  <!-- Lightweight Charts (TradingView) -->
  <script defer src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
  <script defer src="/app.js"></script>
</head>
<body>
  <div class="bg"></div>

  <div class="wrap">
    <header class="topbar">
      <h1>Charly Cripto • MVP</h1>
      <a class="health" href="/healthz" target="_blank">/healthz</a>
    </header>

    <!-- Widget Dólar -->
    <section class="card" id="dolar-card">
      <div class="card-head">
        <h2>Dólar en ARS</h2>
        <div class="muted">Oficial • Blue • Cripto</div>
      </div>
      <div class="dolar-grid">
        <div>
          <div class="muted">Oficial</div>
          <div id="dolar-oficial" class="big-num">—</div>
        </div>
        <div>
          <div class="muted">Blue</div>
          <div id="dolar-blue" class="big-num">—</div>
        </div>
        <div>
          <div class="muted">Cripto (USDT≈USD)</div>
          <div class="row">
            <div id="dolar-cripto" class="big-num">—</div>
            <input id="dolar-cripto-input" class="num-input" type="number" step="0.01" placeholder="set" />
            <button id="dolar-cripto-set" class="btn">Usar</button>
          </div>
          <div class="hint">Si no carga, poné tu valor preferido (ej: 1600)</div>
        </div>
      </div>
    </section>

    <!-- Tabs de Activos -->
    <section class="card">
      <div class="tabs">
        <button class="tab active" data-asset="BTCUSDT">BTC</button>
        <button class="tab" data-asset="ETHUSDT">ETH</button>
        <button class="tab" data-asset="SOLUSDT">SOL</button>
        <span class="sep"></span>
        <button class="tab" data-asset="USDT">USDT</button>
        <button class="tab" data-asset="USDC">USDC</button>
        <button class="tab" data-asset="DAI">DAI</button>
      </div>

      <div class="fx-row">
        <div class="toggle">
          <label><input id="toggle-ars" type="checkbox" /> Mostrar en ARS también</label>
        </div>
        <div class="muted">Fuentes: Binance • Bybit • OKX</div>
      </div>

      <div class="table" id="quotes-table">
        <div class="thead">
          <div>Exchange</div><div>Símbolo</div><div class="right">Precio (USD)</div><div class="right show-ars">Precio (ARS)</div>
        </div>
        <div id="quotes-body" class="tbody"></div>
      </div>
    </section>

    <!-- Gráfico -->
    <section class="card">
      <div class="card-head">
        <h2>Gráfico de Velas (Binance)</h2>
        <div class="muted">Par: <span id="chart-symbol">BTCUSDT</span> • Intervalo:
          <select id="interval">
            <option value="1m">1m</option>
            <option value="5m">5m</option>
            <option value="15m">15m</option>
            <option value="1h" selected>1h</option>
            <option value="4h">4h</option>
            <option value="1d">1d</option>
          </select>
        </div>
      </div>
      <div id="chart" class="chart"></div>
    </section>

    <!-- "IA": análisis técnico simple local -->
    <section class="card">
      <div class="card-head">
        <h2>Análisis técnico rápido</h2>
        <div class="muted">Basado en medias móviles sobre el último dataset del gráfico</div>
      </div>
      <div class="fx-row">
        <div>
          <label>MA corta</label>
          <input id="ma-short" type="number" min="2" max="200" value="9" />
        </div>
        <div>
          <label>MA larga</label>
          <input id="ma-long" type="number" min="3" max="400" value="21" />
        </div>
        <button id="run-analysis" class="btn">Analizar</button>
      </div>
      <pre id="analysis-out" class="pre"></pre>
    </section>

    <footer class="muted foot">© Charly • Hecho para Argentina — fondo: <code>muro.jpg</code></footer>
  </div>
</body>
</html>
